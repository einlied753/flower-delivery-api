# flower-delivery-api
**Сервис для доставки цветов** - представляет собой api приложение, позволяющее клиенту выбрать нужные цветы и другие товары (независимо от того, был ли клиент зарегистрирован в приложении) и заказать доставку по нужному адресу.

## Процесс работы приложения

**Оформление заказа:**

1. Клиент заходит на страницу поиска.

2. (опционально) Клиент логинится или регистрируется:
	- если идет регистрация - создается запись в user

3. Клиент выбирает первый товар:
	- в этот момент приложение создает сущность заказа (order, со статусом = draft)
	- в product_order помещается первая запись, определяющая первый продукт в заказе

4. (опционально) Клиент помещает в корзину следующие товары:
	- в product_order помещается следующая запись
	- в order обновляется стоимость (cost) 

5. (опционально) Клиент может удалить несколько товаров:
	- в product_order удаление строк

6. Клиент бронирует заказ. Ему предлагается залогиниться (зарегистрироваться)
   
   1. Клиент соглашается:
	 - если нет записи в user (клиент не зарегистрирован), то создается запись в user после регистрации; клиент логинится
	 - обновляется user_id в order
	 - в форму заказа подставляются данные из user: адрес, email, телефон; при желании клиент меняет эти данные в заказе

   2. Клиент остается не авторизованным:
	 - в order - user_id остается пустым
	 - клиент заполняет на форме заказа: адрес, email, телефон - данные обновляются в order

7. Клиент забронировал заказ, получатель ожидает доставки:
	- обновление статуса в order
	- клиент видит свой заказ в личном кабинете

8. Получателю доставили заказ, флоу завершился:
   - order переходит в статус done

 <br />
 <br />

**Наглядная блок-схема, описывающая работу приложения:**

![Block diagram](https://github.com/user-attachments/assets/048975b9-5d12-4a72-b917-ccb1ea368c40)

<br />
<br />

## Представление сущностей приложения в базе данных:

![UML](https://github.com/user-attachments/assets/2f8b6c77-ba41-4bd0-a89e-ef6842def8dc)

<br />

**Описание таблиц:**

1. **product** - таблица товаров (цветы и пр.)
   - id - идентификатор товара
   - name - наименование товара
   - price - стоимость товара
   - quantity - количество товара; если кол-во = 0, то товара временно нет в наличии
   - discount - скидка на товар, если имеется

2. **user** - таблица клиентов
   - id - идентификатор клиента
   - fio - ФИО клиента
   - email - эл. почта клиента
   - phone - телефон клиента
   - address - адрес клиента
   - is_active - флажок, обозначающий, активен ли клиент (может пригодиться для рассылок)

3. **order** - таблица заказов
   - id - идентификатор заказа
   - user_id - идентификатор заказчика
   - order_status_id - статус заказа
   - cost - общая стоимость заказа
   - created - дата и время создания заказа
  
4. **order_status** - таблица статусов заказа
   - id - идентификатор статуса заказа
   - name - наименование статуса
   - description - описание статуса

5. **product_order** - связующая таблица между заказами и продуктами, содержит товары, добавленные в заказ
   - id - идентификатор связи между заказами и продуктами
   - order_id - идентификатор заказа
   - product_id - идентификатов товара в заказе 

6. **session** - таблица сессий
   - id - идентификатор сессии
   - user_id - идентификатор пользователя, зашедшего в приложение
   - order_id - идентификатор заказа, созданного в этой сессии
   - created - дата и время захода в приложение пользователем
   - ip_address - IP адрес пользователя

